<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Redux 기본 개념 정리 - yk-dev-blog</title>
<meta name="description" content="Redux는 자바스크립트 어플리케이션을 위한 state 관리 도구 입니다. 그리고 리액트와 사용하는 경우가 많습니다. 리액트는 기본적으로 컴포넌트에서 로컬 state를 관리하기 때문에 컴포넌트 숫자가 늘어날 수록 state 관리가 어렵습니다. Redux는 Store라는 공간에서 어플리케이션의 state를 저장하고 각 컴포넌트에서 저장된 state에 접근하고 업데이트 할 수 있게 해줍니다.">



<meta property="og:type" content="article">
<meta property="og:locale" content="ko">
<meta property="og:site_name" content="yk-dev-blog">
<meta property="og:title" content="Redux 기본 개념 정리">
<meta property="og:url" content="https://midas123.github.io/2019/08/12/react-redux.html">


  <meta property="og:description" content="Redux는 자바스크립트 어플리케이션을 위한 state 관리 도구 입니다. 그리고 리액트와 사용하는 경우가 많습니다. 리액트는 기본적으로 컴포넌트에서 로컬 state를 관리하기 때문에 컴포넌트 숫자가 늘어날 수록 state 관리가 어렵습니다. Redux는 Store라는 공간에서 어플리케이션의 state를 저장하고 각 컴포넌트에서 저장된 state에 접근하고 업데이트 할 수 있게 해줍니다.">







  <meta property="article:published_time" content="2019-08-12T00:00:00+00:00">






<link rel="canonical" href="https://midas123.github.io/2019/08/12/react-redux.html">













<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="yk-dev-blog Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
#scrollToTop {
  display: none;
  position: fixed;
  bottom: 20px;
  right: 30px;
  z-index: 99;
  font-size: 14px;
  border: none;
  outline: none;
  background-color: black;
  color: white;
  cursor: pointer;
  padding: 15px;
  border-radius: 4px;
}


</style>


<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


  


<button onclick="topFunction()" id="scrollToTop" title="Go to top">맨 위로</button>

<script>
  // When the user scrolls down 20px from the top of the document, show the button
  window.onscroll = function() {scrollFunction()};
  
  function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
      document.getElementById("scrollToTop").style.display = "block";
    } else {
      document.getElementById("scrollToTop").style.display = "none";
    }
  }
  
  // When the user clicks on the button, scroll to the top of the document
  function topFunction() {
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;
  }
  </script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-138663237-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-138663237-1');
</script>

<!-- flex slider -->
<link rel="stylesheet" href="/assets/slider/flexslider.css" type="text/css">
<script src="https://code.jquery.com/jquery-1.6.2.js"integrity="sha256-pXKSYZ0U64y9kjvenyjPmUrGarxI98l1t2kyj/M73ck="crossorigin="anonymous"></script>
<script src="/assets/slider/jquery.flexslider.js"></script>
<script src="/assets/slider/jquery.flexslider-min.js"></script>

<style>
@font-face {
 font-family: 'flexslider-icon';
 src: url(/assets/slider/fonts/flexslider-icon.eot);
 src: url(/assets/slider/fonts/flexslider-icon.woff) format('woff'),
      url(/assets/slider/fonts/flexslider-icon.ttf) format('truetype');
}

</style>
<script type="text/javascript" charset="utf-8">
  $(window).load(function() {
    $('.flexslider').flexslider({
      animation: "fade",
      directionNav: true,
      slideshowSpeed: 5000,
      animationSpeed: 600,
      touch: true
    });
  });
</script>

<!-- flex slider end -->

    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
<!-- end custom head snippets -->

  </head>
  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">yk-dev-blog</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/year-archive/" >Archive</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



  
  <div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name"></h3>
    
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="http://midas123.tistory.com/" rel="nofollow noopener noreferrer"><i class="fab fa-blogger" aria-hidden="true"></i> Tistory Blog</a></li>
          
        
          
            <li><a href="https://github.com/midas123" rel="nofollow noopener noreferrer"><i class="fab fa-git-square" aria-hidden="true"></i> Github</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">토글 메뉴</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">MENU</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/year-archive/" class="">최근 포스트</a></li>
          
            
            

            
            

            <li><a href="/#all-tags" class="">모든 태그</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>
    
  
  
</div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Redux 기본 개념 정리">
    <meta itemprop="description" content="Redux는 자바스크립트 어플리케이션을 위한 state 관리 도구 입니다. 그리고 리액트와 사용하는 경우가 많습니다. 리액트는 기본적으로 컴포넌트에서 로컬 state를 관리하기 때문에 컴포넌트 숫자가 늘어날 수록 state 관리가 어렵습니다. Redux는 Store라는 공간에서 어플리케이션의 state를 저장하고 각 컴포넌트에서 저장된 state에 접근하고 업데이트 할 수 있게 해줍니다.">
    <meta itemprop="datePublished" content="August 12, 2019">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Redux 기본 개념 정리
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On This Page</h4></header>
              <ul class="toc__menu">
  <li><a href="#actions">Actions</a></li>
  <li><a href="#action-creators">Action Creators</a></li>
  <li><a href="#reducers">Reducers</a>
    <ul>
      <li><a href="#designing-the-state--shape">Designing the State  Shape</a></li>
      <li><a href="#handling-action">Handling Action</a></li>
      <li><a href="#splitting-reducers">Splitting Reducers</a></li>
    </ul>
  </li>
  <li><a href="#store">Store</a></li>
  <li><a href="#data-flow">Data Flow</a></li>
  <li><a href="#usage-with-react">Usage with React</a>
    <ul>
      <li><a href="#installing-react-redux">Installing React Redux</a></li>
      <li><a href="#presentational-and-container-components">Presentational and Container Components</a></li>
      <li><a href="#presentational-components">Presentational Components</a></li>
      <li><a href="#container-components">Container Components</a></li>
      <li><a href="#other-components">Other Components</a></li>
      <li><a href="#passing-the-store">Passing the Store</a></li>
    </ul>
  </li>
</ul>
            </nav>
          </aside>
        
        <p>Redux는 자바스크립트 어플리케이션을 위한 state 관리 도구 입니다. 그리고 리액트와 사용하는 경우가 많습니다. 리액트는 기본적으로 컴포넌트에서 로컬 state를 관리하기 때문에 컴포넌트 숫자가 늘어날 수록 state 관리가 어렵습니다. Redux는 Store라는 공간에서 어플리케이션의 state를 저장하고 각 컴포넌트에서 저장된 state에 접근하고 업데이트 할 수 있게 해줍니다.</p>

<p><a href="https://blog.logrocket.com/why-use-redux-reasons-with-clear-examples-d21bffd5835/">why-use-redux-reasons-with-clear-examples</a></p>

<h1 id="actions">Actions</h1>

<p>액션은 store에 저장할 정보를 운반하는 역할을 한다. 액션은 store.dispatch()를 이용해서 store로 보낸다. 아래 코드는 todo 앱에 사용되는 액션 중 하나이다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">ADD_TODO</span> <span class="o">=</span> <span class="s1">'ADD_TODO'</span>
</code></pre></div></div>

<p>액션은 자바스크립트 객체로 액션 타입을 나타내는 속성(‘ADD_TODO’)을 꼭 가지고 있어야 한다. 타입은 상수 문자열로 정의되어야 하고 앱의 규모가 크다면 별도의 모듈 안에서 작성해도 된다. 그리고 모듈은 아래처럼 import 한다. <a href="https://redux.js.org/recipes/reducing-boilerplate">reducing-boilerplate</a></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">ADD_TODO</span><span class="p">,</span> <span class="nx">REMOVE_TODO</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'../actionTypes'</span>
</code></pre></div></div>

<p>타입을 제외한 에러, 페이로드, 메타 등의 속성을 포함하는 액션의 구조는 사용자에게 달려있다. <a href="https://github.com/redux-utilities/flux-standard-action">flux-standard-action</a>
각각의 액션은 어플리케이션에서 사용하는 객체 전체 보다는 배열의 인덱스나 유니크 ID 등 최소한의 데이터만 전달하는게 좋다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">type</span><span class="p">:</span> <span class="nx">TOGGLE_TODO</span><span class="p">,</span>
  <span class="nx">index</span><span class="p">:</span> <span class="mi">5</span>
<span class="p">}</span>
</code></pre></div></div>

<p><br /></p>

<h1 id="action-creators">Action Creators</h1>

<p>말그대로 액션을 만드는 함수이다. 액션 크레이터는 단순히 액션을 리턴한다. 액션 사용과 테스트가 쉬워진다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">addTodo</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">type</span><span class="p">:</span> <span class="nx">ADD_TODO</span><span class="p">,</span>
    <span class="nx">text</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><br /></p>

<h1 id="reducers">Reducers</h1>

<p>리듀서는 어플리케이션의 state가 액션 타입에 따라서 어떻게 변해야 하는지 명세한다.</p>

<h2 id="designing-the-state--shape">Designing the State  Shape</h2>

<p>모든 어플리케이션 state는 하나의 객체로 저장된다. 어떤 데이터와 UI state를 state 트리에 저장하되 둘을 구분해야 한다. <a href="https://redux.js.org/faq/organizing-state">organizing-state</a></p>

<p>복잡한 구조의 앱에서 각각의 엔티티가 서로를 참조하는 것을 원한다면 state를 최대한 정규화해야 한다. 모든 엔티티는 ID를 가지고 저장되어야 하고 다른 엔티티나 리스트에서 ID로 참조되어야 한다.</p>

<p><br /></p>

<h2 id="handling-action">Handling Action</h2>

<p>리듀서는 이전의 state와 액션을 받아서 다음 state를 리턴한다. 리듀서는 순수해야 합니다. 인자를 조작하거나 API를 요청하지 말아야 합니다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nx">previousState</span><span class="p">,</span> <span class="nx">action</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">newState</span>
</code></pre></div></div>

<p>리듀서에서는 state를 조작하지 않는다. Object.assign()을 이용해서 state 객체를 새로 복사한다.
반드시 Object.assign()의 첫번째 파라미터를 비워둬야 한다. state를 첫번째에 두면 변해버린다.
swich 조건문을 사용해서 액션 타입에 알맞은 값을 리턴한다. 그리고 알 수 없는 액션에 대비해서 default case에서 이전 state를 리턴해야 한다.</p>

<p>※Object.assign()는 ES6의 일부이므로 오래된 브라우저에선 지원되지 않는다. 대신 <a href="https://polyfill.io/v3/">polyfill</a> 또는 <a href="https://lodash.com/docs#assign"><code class="highlighter-rouge">_.assign()</code></a>을 사용한다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span>
  <span class="nx">ADD_TODO</span><span class="p">,</span>
  <span class="nx">TOGGLE_TODO</span><span class="p">,</span>
  <span class="nx">SET_VISIBILITY_FILTER</span><span class="p">,</span>
  <span class="nx">VisibilityFilters</span>
<span class="p">}</span> <span class="k">from</span> <span class="s1">'./actions'</span>

<span class="p">...</span>

<span class="kd">function</span> <span class="nx">todoApp</span><span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="nx">initialState</span><span class="p">,</span> <span class="nx">action</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">//state = initialState는 아래 코드를 대신함  </span>
  <span class="c1">//if (typeof state === 'undefined') {</span>
    <span class="c1">//return initialState</span>
  <span class="c1">//}  </span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nx">SET_VISIBILITY_FILTER</span><span class="p">:</span>
      <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="nx">state</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">visibilityFilter</span><span class="p">:</span> <span class="nx">action</span><span class="p">.</span><span class="nx">filter</span>
      <span class="p">})</span>
    <span class="k">case</span> <span class="nx">ADD_TODO</span><span class="p">:</span>
      <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="nx">state</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">todos</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">...</span><span class="nx">state</span><span class="p">.</span><span class="nx">todos</span><span class="p">,</span> <span class="c1">//전개구문(Spread_syntax) </span>
          <span class="p">{</span>
            <span class="na">text</span><span class="p">:</span> <span class="nx">action</span><span class="p">.</span><span class="nx">text</span><span class="p">,</span>
            <span class="na">completed</span><span class="p">:</span> <span class="kc">false</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">})</span>
    <span class="k">default</span><span class="p">:</span>
      <span class="k">return</span> <span class="nx">state</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>전개구문 예시: <a href="https://codeburst.io/javascript-es6-the-spread-syntax-f5c35525f754">Spread_syntax</a></p>

<p><br /></p>

<h2 id="splitting-reducers">Splitting Reducers</h2>

<p>리듀서를 아래처럼 나누면 각 리듀서 별로 state를 관리하게 된다. 나누어진 리듀서는 combineReducers()를 이용해서 다시 합칠 수 있다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">combineReducers</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'redux'</span>
<span class="k">import</span> <span class="p">{</span>
  <span class="nx">ADD_TODO</span><span class="p">,</span>
  <span class="nx">TOGGLE_TODO</span><span class="p">,</span>
  <span class="nx">SET_VISIBILITY_FILTER</span><span class="p">,</span>
  <span class="nx">VisibilityFilters</span>
<span class="p">}</span> <span class="k">from</span> <span class="s1">'./actions'</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">SHOW_ALL</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">VisibilityFilters</span>

<span class="kd">function</span> <span class="nx">visibilityFilter</span><span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="nx">SHOW_ALL</span><span class="p">,</span> <span class="nx">action</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nx">SET_VISIBILITY_FILTER</span><span class="p">:</span>
      <span class="k">return</span> <span class="nx">action</span><span class="p">.</span><span class="nx">filter</span>
    <span class="k">default</span><span class="p">:</span>
      <span class="k">return</span> <span class="nx">state</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">todos</span><span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">action</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nx">ADD_TODO</span><span class="p">:</span>
      <span class="k">return</span> <span class="p">[</span>
        <span class="p">...</span><span class="nx">state</span><span class="p">,</span>
        <span class="p">{</span>
          <span class="na">text</span><span class="p">:</span> <span class="nx">action</span><span class="p">.</span><span class="nx">text</span><span class="p">,</span>
          <span class="na">completed</span><span class="p">:</span> <span class="kc">false</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="k">case</span> <span class="nx">TOGGLE_TODO</span><span class="p">:</span>
      <span class="k">return</span> <span class="nx">state</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">todo</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">===</span> <span class="nx">action</span><span class="p">.</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="nx">todo</span><span class="p">,</span> <span class="p">{</span>
            <span class="na">completed</span><span class="p">:</span> <span class="o">!</span><span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span>
          <span class="p">})</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">todo</span>
      <span class="p">})</span>
    <span class="k">default</span><span class="p">:</span>
      <span class="k">return</span> <span class="nx">state</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">todoApp</span> <span class="o">=</span> <span class="nx">combineReducers</span><span class="p">({</span>
  <span class="nx">visibilityFilter</span><span class="p">,</span>
  <span class="nx">todos</span>
<span class="p">})</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">todoApp</span>
</code></pre></div></div>

<p><br /></p>

<h1 id="store">Store</h1>

<p>앞서 상태에 대해 설명해주는 액션과 그 액션에 따라서 state를 업데이트하는 리듀서에 대해 공부했다. 스토어는 이것들을 하나로 묶어준다. 스토어의 역할은 아래와 같다.</p>

<ul>
  <li>어플리케이션 state를 보관한다.</li>
  <li>getState()를 이용한 state에 대한 접근을 허용한다.</li>
  <li>dispatch()로 state의 업데이트를 허용한다.</li>
  <li>subscribe()로 리스너를 등록한다.</li>
  <li>등록되지 않은 리스너를 subscribe()를 리턴하는 함수로 다룬다.</li>
</ul>

<p><br /></p>

<p>어플리케이션에서는 오직 하나의 스토어만 가질 수 있다. 서비스 로직 별로 데이터를 나누려면 리듀서를 나누는 방법을 선택해야 한다.</p>

<p>스토어는 <a href="https://redux.js.org/api/createstore">createStore()</a>에 리듀서를 파라미터로 사용하면 만들 수 있다. 그리고 두 번째 인자로 initial state를 정의할 수 있다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">createStore</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'redux'</span>
<span class="k">import</span> <span class="nx">todoApp</span> <span class="k">from</span> <span class="s1">'./reducers'</span>
<span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">createStore</span><span class="p">(</span><span class="nx">todoApp</span><span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<h1 id="data-flow">Data Flow</h1>

<p>redux는 엄격한 단방향의 데이터 플로우 구조에서 동작한다. 이 말은 곧 어플리케이션의 모든 데이터는 같은 라이프사이클을 갖는 것과 같고 어플리케이션의 로직을 만드는게 더 쉬워지고 예상 가능해진다. 또한 정규화를 장려하므로 같은 데이터를 가진 다수의 중복 코드를 지양한다.</p>

<p>redux 앱에서 데이터 라이프사이클은 아래와 같다.</p>

<ol>
  <li>store.dispatch(action) 호출</li>
  <li>store가 reducer에게 인자를 전달(액션, 현재 state 트리)</li>
  <li>루트 reducer가 다수의 reducer의 결과물을 하나의 state tree와 결합</li>
  <li>store가 루트 reducer가 리턴한 state tree를 저장</li>
</ol>

<p><br /></p>

<h1 id="usage-with-react">Usage with React</h1>

<h2 id="installing-react-redux">Installing React Redux</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm install --save react-redux
</code></pre></div></div>

<p><br /></p>

<h2 id="presentational-and-container-components">Presentational and Container Components</h2>

<p>redux를 위한 리액트 바인딩을 presentational 컴포넌트와 container 컴포넌트로 구분한다. 이 방법은 앱의 구조를 파악과 컴포넌트 재사용이 쉽다.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">Presentational Components</th>
      <th style="text-align: left">Container Components</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">Purpose</td>
      <td style="text-align: left">How things look (markup, styles)</td>
      <td>How things work (data fetching, state updates)</td>
    </tr>
    <tr>
      <td style="text-align: right">Aware of Redux</td>
      <td style="text-align: left">No</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td style="text-align: right">To read data</td>
      <td style="text-align: left">Read data from props</td>
      <td>Subscribe to Redux state</td>
    </tr>
    <tr>
      <td style="text-align: right">To change data</td>
      <td style="text-align: left">Invoke callbacks from props</td>
      <td>Dispatch Redux actions</td>
    </tr>
    <tr>
      <td style="text-align: right">Are written</td>
      <td style="text-align: left">By hand</td>
      <td>Usually generated by React Redux</td>
    </tr>
  </tbody>
</table>

<p>container 컴포넌트는 Redux store와 연결된다. 기술적으로 store.subscribe()를 사용해서 container 컴포넌트를 작성할 수 있지만, React-Redux의 성능 최적화를 직접 구현하기 어렵기 때문에 이 방법을 권하지 않는다.
이러한 이유로 이 컴포넌트를 직접 작성하기 보다는 connect() 함수를 이용해서 생성한다.</p>

<p><br /></p>

<h2 id="presentational-components">Presentational Components</h2>

<p>일반적인 리액트 컴포넌트이다. 로컬 state 또는 라이프 사이클 메서드가 필요한 경우가 아니라면 아래 코드처럼 간단하게 함수 컴포넌트를 사용한다.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="s1">'react'</span>
<span class="k">import</span> <span class="nx">PropTypes</span> <span class="k">from</span> <span class="s1">'prop-types'</span>

<span class="kd">const</span> <span class="nx">Todo</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">onClick</span><span class="p">,</span> <span class="nx">completed</span><span class="p">,</span> <span class="nx">text</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nt">li</span>
    <span class="na">onClick=</span><span class="si">{</span><span class="nx">onClick</span><span class="si">}</span>
    <span class="na">style=</span><span class="err">
  &gt;
    </span><span class="si">{</span><span class="nx">text</span><span class="si">}</span>
  <span class="err">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
)

Todo.propTypes = <span class="si">{</span>
  <span class="nx">onClick</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span>
  <span class="nx">completed</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">bool</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span>
  <span class="nx">text</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">isRequired</span>
<span class="si">}</span>

export default Todo
</code></pre></div></div>

<p><br /></p>

<h2 id="container-components">Container Components</h2>

<p>presentational 컴포넌트를 Redux에 연결하려면 이 컴포넌트가 필요하다. 이전에 언급한 것처럼 기술적으로만 보면 container 컴포넌트는 Redux state 트리의 일부분을 읽는 store.subscribe()를 사용하는 리액트 컴포넌트이다. 하지만 여러가지 최적화를 제공하고 불필요한 re-render를 예방 할 수 있는 React-Redux 라이브러리의 connect() 함수를 사용하는 것을 추천한다.</p>

<p>connect()를 사용하기 위해서는 mapStateToProps 함수를 정의해야 한다. 이 함수는 현재의 Redux store state가 presentational 컴포넌트의 prop으로 전달되기 위해서 어떻게 변해야 하는지를 기술한다.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">getVisibleTodos</span> <span class="o">=</span> <span class="p">(</span><span class="nx">todos</span><span class="p">,</span> <span class="nx">filter</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">filter</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="s1">'SHOW_COMPLETED'</span><span class="p">:</span>
      <span class="k">return</span> <span class="nx">todos</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">t</span> <span class="o">=&gt;</span> <span class="nx">t</span><span class="p">.</span><span class="nx">completed</span><span class="p">)</span>
    <span class="k">case</span> <span class="s1">'SHOW_ACTIVE'</span><span class="p">:</span>
      <span class="k">return</span> <span class="nx">todos</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">t</span> <span class="o">=&gt;</span> <span class="o">!</span><span class="nx">t</span><span class="p">.</span><span class="nx">completed</span><span class="p">)</span>
    <span class="k">case</span> <span class="s1">'SHOW_ALL'</span><span class="p">:</span>
    <span class="na">default</span><span class="p">:</span>
      <span class="k">return</span> <span class="nx">todos</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">mapStateToProps</span> <span class="o">=</span> <span class="nx">state</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">todos</span><span class="p">:</span> <span class="nx">getVisibleTodos</span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">todos</span><span class="p">,</span> <span class="nx">state</span><span class="p">.</span><span class="nx">visibilityFilter</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>또한 container 컴포넌트는 action을 dispatch 할 수 있다. 위와 비슷한 방식으로, dispatch()를 받고 presentational 컴포넌트에 주입하고자 하는 콜백 props를 리턴하는 mapDispatchToProps()을 호출한다.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">mapDispatchToProps</span> <span class="o">=</span> <span class="nx">dispatch</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">onTodoClick</span><span class="p">:</span> <span class="nx">id</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">dispatch</span><span class="p">(</span><span class="nx">toggleTodo</span><span class="p">(</span><span class="nx">id</span><span class="p">))</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>mapStateToProps와mapDispatchToProps를 통시에 전달</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">connect</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'react-redux'</span>

<span class="kd">const</span> <span class="nx">VisibleTodoList</span> <span class="o">=</span> <span class="nx">connect</span><span class="p">(</span>
  <span class="nx">mapStateToProps</span><span class="p">,</span>
  <span class="nx">mapDispatchToProps</span>
<span class="p">)(</span><span class="nx">TodoList</span><span class="p">)</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">VisibleTodoList</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="other-components">Other Components</h2>

<p>presentational과 container 구분이 어려운 컴포넌트를 말한다. 예를 들면 form 엘리먼트와 함수가 결합되어 있는 경우가 있다. 아래 AddTodo 컴포넌트는 프레젠테이션과 로직이 섞여있다.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="s1">'react'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">connect</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'react-redux'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">addTodo</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'../actions'</span>

<span class="kd">let</span> <span class="nx">AddTodo</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">dispatch</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">input</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">form</span>
        <span class="na">onSubmit=</span><span class="si">{</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">trim</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span>
          <span class="p">}</span>
          <span class="nx">dispatch</span><span class="p">(</span><span class="nx">addTodo</span><span class="p">(</span><span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="p">))</span>
          <span class="nx">input</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">''</span>
        <span class="p">}</span><span class="si">}</span>
      <span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span>
          <span class="na">ref=</span><span class="si">{</span><span class="nx">node</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">input</span> <span class="o">=</span> <span class="nx">node</span>
          <span class="p">}</span><span class="si">}</span>
        <span class="p">/&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type=</span><span class="s2">"submit"</span><span class="p">&gt;</span>Add Todo<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>
<span class="nx">AddTodo</span> <span class="o">=</span> <span class="nx">connect</span><span class="p">()(</span><span class="nx">AddTodo</span><span class="p">)</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">AddTodo</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="passing-the-store">Passing the Store</h2>

<p>container 컴포넌트는 Redux store에 접근해야 한다. 모든 container 컴포넌트로 store를 전달하는 방법 외에 Provider라는 React-Redux 컴포넌트로 한번에 store 전달하는 방법이 있다. 아래와 같이 root 컴포넌트를 렌더링할때 사용해주면 된다.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="s1">'react'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">render</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'react-dom'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Provider</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'react-redux'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">createStore</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'redux'</span>
<span class="k">import</span> <span class="nx">todoApp</span> <span class="k">from</span> <span class="s1">'./reducers'</span>
<span class="k">import</span> <span class="nx">App</span> <span class="k">from</span> <span class="s1">'./components/App'</span>

<span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">createStore</span><span class="p">(</span><span class="nx">todoApp</span><span class="p">)</span>

<span class="nx">render</span><span class="p">(</span>
  <span class="p">&lt;</span><span class="nc">Provider</span> <span class="na">store=</span><span class="si">{</span><span class="nx">store</span><span class="si">}</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nc">App</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nc">Provider</span><span class="p">&gt;,</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'root'</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>

<p><br /><br /></p>

<p>출처: https://redux.js.org/basics/actions</p>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/react" class="page__taxonomy-item" rel="tag">react</a><span class="sep">, </span>
    
      
      
      <a href="/tags/redux" class="page__taxonomy-item" rel="tag">redux</a>
    
    </span>
  </p>




        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time datetime="2019-08-12T00:00:00+00:00">August 12, 2019</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/2019/08/01/rest-basic2.html" class="pagination--pager" title="React 기본 개념 정리2
">이전</a>
    
    
      <a href="/2019/08/17/react-redux-api-methods.html" class="pagination--pager" title="Redux - 주요 API 함수
">다음</a>
    
  </nav>

    </div>

    
    <section id="disqus_thread">
    <script>
    
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://ykblog-2.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </section>
  </article>

  
  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow" style="padding-top: 10px;">
   <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
  </ul>
</div> -->

<div class="page__footer-copyright">&copy; 2019 yk-dev-blog. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  








  </body>
</html>
