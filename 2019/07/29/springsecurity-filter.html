<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>스프링시큐리티 - 필터 설정 - yk-dev-blog</title>
<meta name="description" content="스프링 시큐리티 내에서 요청에 대한 인증과 접근을 관리하는 시프링 시큐리티 필터에 대해 간단하게 알아보았습니다.">



<meta property="og:type" content="article">
<meta property="og:locale" content="ko">
<meta property="og:site_name" content="yk-dev-blog">
<meta property="og:title" content="스프링시큐리티 - 필터 설정">
<meta property="og:url" content="https://midas123.github.io/2019/07/29/springsecurity-filter.html">


  <meta property="og:description" content="스프링 시큐리티 내에서 요청에 대한 인증과 접근을 관리하는 시프링 시큐리티 필터에 대해 간단하게 알아보았습니다.">







  <meta property="article:published_time" content="2019-07-29T00:00:00+00:00">






<link rel="canonical" href="https://midas123.github.io/2019/07/29/springsecurity-filter.html">













<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="yk-dev-blog Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
#scrollToTop {
  display: none;
  position: fixed;
  bottom: 20px;
  right: 30px;
  z-index: 99;
  font-size: 14px;
  border: none;
  outline: none;
  background-color: black;
  color: white;
  cursor: pointer;
  padding: 15px;
  border-radius: 4px;
}


</style>


<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


  


<button onclick="topFunction()" id="scrollToTop" title="Go to top">맨 위로</button>

<script>
  // When the user scrolls down 20px from the top of the document, show the button
  window.onscroll = function() {scrollFunction()};
  
  function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
      document.getElementById("scrollToTop").style.display = "block";
    } else {
      document.getElementById("scrollToTop").style.display = "none";
    }
  }
  
  // When the user clicks on the button, scroll to the top of the document
  function topFunction() {
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;
  }
  </script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-138663237-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-138663237-1');
</script>

<!-- flex slider -->
<link rel="stylesheet" href="/assets/slider/flexslider.css" type="text/css">
<script src="https://code.jquery.com/jquery-1.6.2.js"integrity="sha256-pXKSYZ0U64y9kjvenyjPmUrGarxI98l1t2kyj/M73ck="crossorigin="anonymous"></script>
<script src="/assets/slider/jquery.flexslider.js"></script>
<script src="/assets/slider/jquery.flexslider-min.js"></script>

<style>
@font-face {
 font-family: 'flexslider-icon';
 src: url(/assets/slider/fonts/flexslider-icon.eot);
 src: url(/assets/slider/fonts/flexslider-icon.woff) format('woff'),
      url(/assets/slider/fonts/flexslider-icon.ttf) format('truetype');
}

</style>
<script type="text/javascript" charset="utf-8">
  $(window).load(function() {
    $('.flexslider').flexslider({
      animation: "fade",
      directionNav: true,
      slideshowSpeed: 5000,
      animationSpeed: 600,
      touch: true
    });
  });
</script>

<!-- flex slider end -->

    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
<!-- end custom head snippets -->

  </head>
  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">yk-dev-blog</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/year-archive/" >Archive</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



  
  <div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name"></h3>
    
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="http://midas123.tistory.com/" rel="nofollow noopener noreferrer"><i class="fab fa-blogger" aria-hidden="true"></i> Tistory Blog</a></li>
          
        
          
            <li><a href="https://github.com/midas123" rel="nofollow noopener noreferrer"><i class="fab fa-git-square" aria-hidden="true"></i> Github</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">토글 메뉴</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">MENU</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/year-archive/" class="">최근 포스트</a></li>
          
            
            

            
            

            <li><a href="/#all-tags" class="">모든 태그</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>
    
  
  
</div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="스프링시큐리티 - 필터 설정">
    <meta itemprop="description" content="스프링 시큐리티 내에서 요청에 대한 인증과 접근을 관리하는 시프링 시큐리티 필터에 대해 간단하게 알아보았습니다.">
    <meta itemprop="datePublished" content="July 29, 2019">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">스프링시큐리티 - 필터 설정
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On This Page</h4></header>
              <ul class="toc__menu">
  <li><a href="#the-security-filter-chain">The Security Filter Chain</a></li>
  <li><a href="#delegatingfilterproxy">DelegatingFilterProxy</a></li>
  <li><a href="#filterchainproxy">FilterChainProxy</a></li>
  <li><a href="#필터-우회하기">필터 우회하기</a></li>
</ul>
            </nav>
          </aside>
        
        <p>스프링 시큐리티 내에서 요청에 대한 인증과 접근을 관리하는 시프링 시큐리티 필터에 대해 간단하게 알아보았습니다.</p>

<h2 id="the-security-filter-chain">The Security Filter Chain</h2>

<p>Spring Security’s web infrastructure는 서블릿 필터 기반입니다. 필터는 내부적으로 서블릿을 사용하거나 서블릿 기반에 프레임워크(ex. Spring MVC)를 사용하지 않습니다. 그러므로 특정 웹 기술과 깊게 연관되지 않습니다.</p>

<p>그리고 시큐리티 필터는 HttpServletRequest와 HttpServletResponse를 다룹니다. request가 어디에서 오는지는 상관하지 않습니다. (웹 브라우저, 웹  서비스 클라이언트, HttpInvoker, AJAX 등)</p>

<p>스프링 시큐리티는 내부적으로 필터 체인을 유지합니다. 그리고 각 필터마다 역할이 주어져 있고 configuration에 의해서 추가 또는 제거 됩니다. 필터 간에 의존이 있기 때문에 순서가 매우 중요합니다. xml 네임 스페이스 설정을 사용한다면 필터는 자동으로 설정되므로 따로 스프링 빈을 정의할 필요 없습니다. 하지만 네임스페이스는 시큐리티 필터를 완전히 관리할 수 없고 커스텀 설정을 지원하지 않습니다.</p>

<p><br /></p>

<h2 id="delegatingfilterproxy">DelegatingFilterProxy</h2>

<p>서블릿 필터를 사용하려면 web.xml 필터를 설정해야 합니다. 그렇지 않으면 서블릿 컨테이너는 필터를 무시합니다. 모든 필터 클래스는 스프링 빈으로 다른 스프링 빈처럼 스프링 의존 주입과 라이프 사이클 혜택을 받습니다.</p>

<p>DelegatingFilterProxy는 web.xml과 ApplicationContext 사이에 연결을 제공합니다. ApplicationContext는 컨테이너 내의 스프링 빈의 초기화, 설정 등을 책임지는 스프링 컨테이너를 나타냅니다.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;filter&gt;</span>
<span class="nt">&lt;filter-name&gt;</span>myFilter<span class="nt">&lt;/filter-name&gt;</span>
<span class="nt">&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span class="nt">&lt;/filter-class&gt;</span>
<span class="nt">&lt;/filter&gt;</span>

<span class="nt">&lt;filter-mapping&gt;</span>
<span class="nt">&lt;filter-name&gt;</span>myFilter<span class="nt">&lt;/filter-name&gt;</span>
<span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/filter-mapping&gt;</span>
</code></pre></div></div>

<p>DelegatingFilterProxy는 실제로 필터의 로직을 실행하지 않습니다. 스프링 어플리케이션 컨텍스트에 있는 빈을 통해서 필터의 메서드를 위임합니다.</p>

<p><br /></p>

<h2 id="filterchainproxy">FilterChainProxy</h2>

<p>스프링 시큐리티 웹 기반은 오직 FilterChainProxy 인스턴스 위임에 의해서만 사용되어야 합니다. 스프링 시큐리티 필터 자체를 사용해서는 안됩니다. 예를 들어 웹 어플리케이션 컨텍스트 파일에 각각의 스프링 시큐리티 필터 빈을 순서까지 고려해서 선언하고 각 필터를 일치시키는 설정을 web.xml에 추가한다면 필터가 많아지면 많아 질수록 매우 혼란 스러울 것 입니다.</p>

<p>FilterChainProxy는 하나의 entry를 web.xml에 추가해서 어플리케이션 전체의 웹 시큐리티 빈을 관리하도록 합니다.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"filterChainProxy"</span> <span class="na">class=</span><span class="s">"org.springframework.security.web.FilterChainProxy"</span><span class="nt">&gt;</span>
<span class="nt">&lt;constructor-arg&gt;</span>
    <span class="nt">&lt;list&gt;</span>
    <span class="nt">&lt;sec:filter-chain</span> <span class="na">pattern=</span><span class="s">"/restful/**"</span> <span class="na">filters=</span><span class="s">"
        securityContextPersistenceFilterWithASCFalse,
        basicAuthenticationFilter,
        exceptionTranslationFilter,
        filterSecurityInterceptor"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;sec:filter-chain</span> <span class="na">pattern=</span><span class="s">"/**"</span> <span class="na">filters=</span><span class="s">"
        securityContextPersistenceFilterWithASCTrue,
        formLoginFilter,
        exceptionTranslationFilter,
        filterSecurityInterceptor"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/list&gt;</span>
<span class="nt">&lt;/constructor-arg&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div></div>

<p>네임 스페이스 엘리먼트 중 filter-chain은 어플리케이션에 필요한 시큐리티 필터 체인을 만드는데 사용됩니다. 특정 URL 패턴을 필터가 담긴 리스트에 맵핑 설정 합니다.</p>

<p>그러면 런타임에서 FilterChainProxy가 현재 웹 요청에 일치하는 URI 패턴의 위치를 파악하고 해당되는 필터 리스트가 그 요청에 적용됩니다. 필터는 정의된 순서로 호출됩니다.</p>

<p><br /></p>

<h2 id="필터-우회하기">필터 우회하기</h2>

<p>filters =”none” 속성을 사용하면 해당 URI 패턴에 대한 요청을 스프링 시큐리티 필터를 거치지 않게 됩니다.인증이나 권한 부여 절차를 거치지 않고 자유롭게 접근 가능해 집니다.</p>

<p>요청을 처리하는 동안 SecurityContext의 컨텐츠를 사용하고 싶다면 꼭 시큐리티 필터를 거치게 설정해야 합니다. 만약 그렇게 하지 않는다면 SecurityContextHolder는 컨텐츠가 없는 null 상태가 됩니다.</p>

<p><br /></p>

<p>출처:https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#security-filter-chain</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/security-filter" class="page__taxonomy-item" rel="tag">security-filter</a><span class="sep">, </span>
    
      
      
      <a href="/tags/spring" class="page__taxonomy-item" rel="tag">spring</a><span class="sep">, </span>
    
      
      
      <a href="/tags/spring-security" class="page__taxonomy-item" rel="tag">spring-security</a>
    
    </span>
  </p>




        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time datetime="2019-07-29T00:00:00+00:00">July 29, 2019</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/2019/07/23/recursion-pibonacci.html" class="pagination--pager" title="피보나치 수열과 재귀 함수 &amp; call stack
">이전</a>
    
    
      <a href="/2019/07/29/springsecurity.html" class="pagination--pager" title="스프링시큐리티 - authentication
">다음</a>
    
  </nav>

    </div>

    
    <section id="disqus_thread">
    <script>
    
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://ykblog-2.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </section>
  </article>

  
  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow" style="padding-top: 10px;">
   <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
  </ul>
</div> -->

<div class="page__footer-copyright">&copy; 2019 yk-dev-blog. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  








  </body>
</html>
